2025-12-06 20:50:10.953 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - ==========================================
2025-12-06 20:50:10.953 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain -        POP3 Server - Java 25 Edition     
2025-12-06 20:50:10.953 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - ==========================================
2025-12-06 20:50:10.953 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - Java 版本: 25.0.1
2025-12-06 20:50:10.954 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - 虚拟线程支持: 已启用
2025-12-06 20:50:10.954 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - 预览特性: 已启用
2025-12-06 20:50:10.956 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.server.Pop3Server - 正在启动 POP3 服务器...
2025-12-06 20:50:10.956 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.server.Pop3Server - 配置: Pop3ServerConfig{domain='localhost', port=1100, maxConnections=500, connectionTimeout=60000, readTimeout=600000, requireAuth=true, authFailedMaxAttempts=3, autoLogoutTimeout=600000}
2025-12-06 20:50:10.957 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.db.DatabaseInitializer - 初始化数据库...
2025-12-06 20:50:10.957 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.db.DatabaseConfig - 已加载配置文件 application.properties
2025-12-06 20:50:10.960 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.db.DatabaseConfig - 初始化数据库连接池: jdbc:postgresql://localhost:5432/maildb
2025-12-06 20:50:10.961 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.zaxxer.hikari.HikariDataSource - Pop3MailPool - Starting...
2025-12-06 20:50:12.016 [virtual-50] INFO  com.yhm.pop3.Pop3ServerMain - 收到关闭信号，正在停止 POP3 服务器...
2025-12-06 21:07:36.404 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - ==========================================
2025-12-06 21:07:36.404 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain -        POP3 Server - Java 25 Edition     
2025-12-06 21:07:36.404 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - ==========================================
2025-12-06 21:07:36.404 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - Java 版本: 25.0.1
2025-12-06 21:07:36.405 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - 虚拟线程支持: 已启用
2025-12-06 21:07:36.405 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - 预览特性: 已启用
2025-12-06 21:07:36.407 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.server.Pop3Server - 正在启动 POP3 服务器...
2025-12-06 21:07:36.408 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.server.Pop3Server - 配置: Pop3ServerConfig{domain='localhost', port=1100, maxConnections=500, connectionTimeout=60000, readTimeout=600000, requireAuth=true, authFailedMaxAttempts=3, autoLogoutTimeout=600000}
2025-12-06 21:07:36.410 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.db.DatabaseInitializer - 初始化数据库...
2025-12-06 21:07:36.411 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.db.DatabaseConfig - 已加载配置文件 application.properties
2025-12-06 21:07:36.415 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.db.DatabaseConfig - 初始化数据库连接池: jdbc:postgresql://localhost:5432/maildb
2025-12-06 21:07:36.417 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.zaxxer.hikari.HikariDataSource - Pop3MailPool - Starting...
2025-12-06 21:07:38.888 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.zaxxer.hikari.pool.HikariPool - Pop3MailPool - Added connection org.postgresql.jdbc.PgConnection@281bbdeb
2025-12-06 21:07:38.889 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.zaxxer.hikari.HikariDataSource - Pop3MailPool - Start completed.
2025-12-06 21:07:38.894 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 执行 SQL: CREATE INDEX IF NOT EXISTS idx_emails_received_at ON emails(received_at DESC)
2025-12-06 21:07:38.912 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 执行 SQL: CREATE INDEX IF NOT EXISTS idx_emails_is_deleted ON emails(is_deleted)
2025-12-06 21:07:38.913 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 执行 SQL: CREATE INDEX IF NOT EXISTS idx_emails_owner_deleted ON emails(owner, is_deleted)
2025-12-06 21:07:38.914 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 执行 SQL: CREATE INDEX IF NOT EXISTS idx_users_domain ON users(domain)
2025-12-06 21:07:38.920 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 执行 SQL: INSERT INTO mail_domains (domain, description, is_local, is_enabled) VALUES ('example.com', 'Example...
2025-12-06 21:07:38.921 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 执行 SQL: INSERT INTO users (email, username, password_hash, domain) VALUES ('admin@localhost', 'admin', 'admi...
2025-12-06 21:07:38.921 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 执行 SQL: INSERT INTO users (email, username, password_hash, domain) VALUES ('user@example.com', 'user', 'user...
2025-12-06 21:07:38.928 [com.yhm.pop3.Pop3ServerMain.main()] ERROR com.yhm.pop3.db.DatabaseInitializer - 数据库初始化失败: ERROR: syntax error at or near "RETURN"
  Position: 1
org.postgresql.util.PSQLException: ERROR: syntax error at or near "RETURN"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:356)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:341)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:317)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:312)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at com.yhm.pop3.db.DatabaseInitializer.executeSchema(DatabaseInitializer.java:78)
	at com.yhm.pop3.db.DatabaseInitializer.initialize(DatabaseInitializer.java:47)
	at com.yhm.pop3.server.Pop3Server.start(Pop3Server.java:61)
	at com.yhm.pop3.Pop3ServerMain.startServer(Pop3ServerMain.java:88)
	at com.yhm.pop3.Pop3ServerMain.lambda$main$0(Pop3ServerMain.java:53)
	at java.base/jdk.internal.vm.ScopedValueContainer.runWithoutScope(ScopedValueContainer.java:112)
	at java.base/jdk.internal.vm.ScopedValueContainer.run(ScopedValueContainer.java:98)
	at java.base/java.lang.ScopedValue$Carrier.run(ScopedValue.java:466)
	at com.yhm.pop3.Pop3ServerMain.main(Pop3ServerMain.java:52)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.codehaus.mojo.exec.AbstractExecJavaBase.executeMainMethod(AbstractExecJavaBase.java:402)
	at org.codehaus.mojo.exec.ExecJavaMojo.executeMainMethod(ExecJavaMojo.java:142)
	at org.codehaus.mojo.exec.AbstractExecJavaBase.doExecClassLoader(AbstractExecJavaBase.java:377)
	at org.codehaus.mojo.exec.AbstractExecJavaBase.lambda$execute$0(AbstractExecJavaBase.java:287)
	at java.base/java.lang.Thread.run(Thread.java:1474)
2025-12-06 21:07:53.994 [virtual-45] INFO  com.yhm.pop3.Pop3ServerMain - 收到关闭信号，正在停止 POP3 服务器...
2025-12-06 21:09:32.281 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - ==========================================
2025-12-06 21:09:32.282 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain -        POP3 Server - Java 25 Edition     
2025-12-06 21:09:32.282 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - ==========================================
2025-12-06 21:09:32.282 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - Java 版本: 25.0.1
2025-12-06 21:09:32.283 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - 虚拟线程支持: 已启用
2025-12-06 21:09:32.283 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.Pop3ServerMain - 预览特性: 已启用
2025-12-06 21:09:32.285 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.server.Pop3Server - 正在启动 POP3 服务器...
2025-12-06 21:09:32.285 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.server.Pop3Server - 配置: Pop3ServerConfig{domain='localhost', port=1100, maxConnections=500, connectionTimeout=60000, readTimeout=600000, requireAuth=true, authFailedMaxAttempts=3, autoLogoutTimeout=600000}
2025-12-06 21:09:32.286 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.db.DatabaseInitializer - 初始化数据库...
2025-12-06 21:09:32.287 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.db.DatabaseConfig - 已加载配置文件 application.properties
2025-12-06 21:09:32.290 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.db.DatabaseConfig - 初始化数据库连接池: jdbc:postgresql://localhost:5432/maildb
2025-12-06 21:09:32.292 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.zaxxer.hikari.HikariDataSource - Pop3MailPool - Starting...
2025-12-06 21:09:32.446 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.zaxxer.hikari.pool.HikariPool - Pop3MailPool - Added connection org.postgresql.jdbc.PgConnection@483d52eb
2025-12-06 21:09:32.446 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.zaxxer.hikari.HikariDataSource - Pop3MailPool - Start completed.
2025-12-06 21:09:32.451 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 执行 SQL: CREATE INDEX IF NOT EXISTS idx_emails_received_at ON emails(received_at DESC)
2025-12-06 21:09:32.452 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 执行 SQL: CREATE INDEX IF NOT EXISTS idx_emails_is_deleted ON emails(is_deleted)
2025-12-06 21:09:32.453 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 执行 SQL: CREATE INDEX IF NOT EXISTS idx_emails_owner_deleted ON emails(owner, is_deleted)
2025-12-06 21:09:32.454 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 执行 SQL: CREATE INDEX IF NOT EXISTS idx_users_domain ON users(domain)
2025-12-06 21:09:32.458 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 执行 SQL: INSERT INTO mail_domains (domain, description, is_local, is_enabled) VALUES ('example.com', 'Example...
2025-12-06 21:09:32.459 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 执行 SQL: INSERT INTO users (email, username, password_hash, domain) VALUES ('admin@localhost', 'admin', 'admi...
2025-12-06 21:09:32.460 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 执行 SQL: INSERT INTO users (email, username, password_hash, domain) VALUES ('user@example.com', 'user', 'user...
2025-12-06 21:09:32.467 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 忽略 SQL 错误: ERROR: trigger "update_users_updated_at" for relation "users" already exists
2025-12-06 21:09:32.469 [com.yhm.pop3.Pop3ServerMain.main()] DEBUG com.yhm.pop3.db.DatabaseInitializer - 忽略 SQL 错误: ERROR: trigger "update_mail_domains_updated_at" for relation "mail_domains" already exists
2025-12-06 21:09:32.469 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.db.DatabaseInitializer - 数据库初始化完成
2025-12-06 21:09:32.470 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.server.Pop3Server - POP3 服务器已启动，监听端口: 1100
2025-12-06 21:09:32.470 [com.yhm.pop3.Pop3ServerMain.main()] INFO  com.yhm.pop3.server.Pop3Server - 使用虚拟线程处理连接
2025-12-06 21:11:39.883 [pop3-handler-0] INFO  c.y.p.server.Pop3ConnectionHandler - 新 POP3 连接: /[0:0:0:0:0:0:0:1]:54422 (虚拟线程: true, 线程名: pop3-handler-0)
2025-12-06 21:11:39.885 [pop3-handler-0] DEBUG c.y.p.server.Pop3ConnectionHandler - 发送: +OK localhost POP3 server ready <49286.1765026699883@localhost>
2025-12-06 21:11:45.301 [pop3-handler-0] DEBUG c.y.p.server.Pop3ConnectionHandler - 收到: USER test@localhost
2025-12-06 21:11:45.336 [pop3-handler-0] DEBUG c.y.p.server.Pop3ConnectionHandler - 发送: +OK user accepted
2025-12-06 21:11:49.366 [pop3-handler-0] DEBUG c.y.p.server.Pop3ConnectionHandler - 收到: PASS ********
2025-12-06 21:11:49.378 [pop3-handler-0] DEBUG com.yhm.pop3.db.Pop3EmailRepository - 邮箱已锁定: test@localhost
2025-12-06 21:11:49.399 [pop3-handler-0] DEBUG com.yhm.pop3.db.Pop3EmailRepository - 为用户 test@localhost 加载了 0 封邮件
2025-12-06 21:11:49.404 [pop3-handler-0] DEBUG c.y.p.server.Pop3ConnectionHandler - 发送: +OK maildrop has 0 messages (0 octets)
2025-12-06 21:11:52.889 [pop3-handler-0] DEBUG c.y.p.server.Pop3ConnectionHandler - 收到: STAT
2025-12-06 21:11:52.890 [pop3-handler-0] DEBUG c.y.p.server.Pop3ConnectionHandler - 发送: +OK 0 0
2025-12-06 21:11:57.437 [pop3-handler-0] DEBUG c.y.p.server.Pop3ConnectionHandler - 收到: LIST
2025-12-06 21:11:57.460 [pop3-handler-0] DEBUG c.y.p.server.Pop3ConnectionHandler - 发送: +OK 0 messages (0 octets)
2025-12-06 21:11:57.460 [pop3-handler-0] DEBUG c.y.p.server.Pop3ConnectionHandler - 发送: .
2025-12-06 21:12:01.093 [pop3-handler-0] DEBUG c.y.p.server.Pop3ConnectionHandler - 收到: QUIT
2025-12-06 21:12:01.104 [pop3-handler-0] DEBUG com.yhm.pop3.db.Pop3EmailRepository - 邮箱已解锁: test@localhost
2025-12-06 21:12:01.107 [pop3-handler-0] DEBUG c.y.p.server.Pop3ConnectionHandler - 发送: +OK localhost POP3 server signing off (0 messages deleted)
2025-12-06 21:12:01.111 [pop3-handler-0] INFO  c.y.p.server.Pop3ConnectionHandler - POP3 连接关闭: /[0:0:0:0:0:0:0:1]:54422
2025-12-06 21:13:14.476 [virtual-45] INFO  com.yhm.pop3.Pop3ServerMain - 收到关闭信号，正在停止 POP3 服务器...
2025-12-06 21:13:14.520 [virtual-45] INFO  com.yhm.pop3.server.Pop3Server - 正在停止 POP3 服务器...
2025-12-06 21:13:14.545 [virtual-45] INFO  com.zaxxer.hikari.HikariDataSource - Pop3MailPool - Shutdown initiated...
2025-12-06 21:13:14.562 [virtual-45] INFO  com.zaxxer.hikari.HikariDataSource - Pop3MailPool - Shutdown completed.
2025-12-06 21:13:14.562 [virtual-45] INFO  com.yhm.pop3.db.DatabaseConfig - 数据库连接池已关闭
2025-12-06 21:13:14.562 [virtual-45] INFO  com.yhm.pop3.server.Pop3Server - POP3 服务器已停止
