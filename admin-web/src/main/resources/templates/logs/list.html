<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">
<head>
    <title>发送日志</title>
</head>
<body>
    <th:block layout:fragment="breadcrumb">
        <a th:href="@{/}">首页</a>
        <span class="separator">/</span>
        <span>发送日志</span>
    </th:block>

    <div layout:fragment="content" class="page-logs">
        <!-- 页面头部 -->
        <div class="page-header">
            <h1>发送日志</h1>
        </div>

        <!-- 状态统计 -->
        <div class="delivery-stats-bar">
            <div class="stat-item delivered">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20 6 9 17 4 12"/>
                </svg>
                <span class="stat-count" th:text="${statusCounts.delivered}">0</span>
                <span class="stat-label">已送达</span>
            </div>
            <div class="stat-item bounced">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
                <span class="stat-count" th:text="${statusCounts.bounced}">0</span>
                <span class="stat-label">退回</span>
            </div>
            <div class="stat-item deferred">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <polyline points="12 6 12 12 16 14"/>
                </svg>
                <span class="stat-count" th:text="${statusCounts.deferred}">0</span>
                <span class="stat-label">延迟</span>
            </div>
        </div>

        <!-- 筛选栏 -->
        <div class="filter-bar">
            <div class="search-input-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                </svg>
                <input type="text" 
                       name="search" 
                       placeholder="搜索收件人..." 
                       th:value="${search}"
                       hx-get="/logs/table"
                       hx-target="#log-table-container"
                       hx-trigger="keyup changed delay:300ms"
                       hx-include="[name='search'], [name='status']">
            </div>
            
            <select name="status" 
                    hx-get="/logs/table"
                    hx-target="#log-table-container"
                    hx-trigger="change"
                    hx-include="[name='search'], [name='status']">
                <option value="">全部状态</option>
                <option value="delivered" th:selected="${selectedStatus == 'delivered'}">已送达</option>
                <option value="bounced" th:selected="${selectedStatus == 'bounced'}">退回</option>
                <option value="deferred" th:selected="${selectedStatus == 'deferred'}">延迟</option>
            </select>
        </div>

        <!-- 表格区域 -->
        <div id="log-table-container">
            <th:block th:replace="~{logs/fragments/table :: log-table}"/>
        </div>
    </div>
</body>
</html>

